<header class="w-full flex bg-white justify-around items-center">
  <!--izquierda-->
  <div class="flex items-center gap-3">
    <!-- Botón hamburguesa SOLO móvil -->
    <button
      type="button"
      class="md:hidden p-2 -ml-2"
      (click)="toggleMobileMenu()"
    >
      <svg
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M4 7H20M4 12H20M4 17H20"
          stroke="#022954"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
    </button>

    <!-- LOGO (deja tus clases actuales) -->
    <a [routerLink]="['/']" class="flex items-center">
      <img
        src="/assets/icons/fadiarLogo.png"
        alt="Grupo Fadiar"
        class="h-15 hidden md:inline"
      />
    </a>
  </div>

  <!--centro-->
  <div class="flex-col mx-2">
    <app-product-search
      (termChange)="onTermChange($event)"
    ></app-product-search>

    <div class="bg-background px-3 hidden sm:inline">
      <ul
        class="flex items-center justify-center w-full gap-5 md:gap-10 xl:gap-14 text-sm font-sans"
      >
        <li>
          <a
            routerLink="/"
            routerLinkActive="font-bold"
            class="hover:text-primary cursor-pointer transition"
          >
            Inicio
          </a>
        </li>

        <li>
          <a
            routerLink="/product"
            routerLinkActive="font-bold"
            class="hover:text-primary transition"
          >
            Productos
          </a>
        </li>

        <li>
          <a
            routerLink="/about"
            routerLinkActive="font-bold"
            class="hover:text-primary transition"
          >
            About Us
          </a>
        </li>

        <li>
          <a
            routerLink="/faq"
            routerLinkActive="font-bold"
            class="hover:text-primary transition"
          >
            FAQ
          </a>
        </li>

        <li>
          <a
            routerLink="/contacto"
            routerLinkActive="font-bold"
            class="hover:text-primary transition"
          >
            Contacto
          </a>
        </li>
      </ul>
    </div>
  </div>

  <!-- DERECHA NAVBAR: carrito + perfil -->
  <div class="flex items-center gap-6">
    <!-- CARRITO (pon aquí tu icono y lógica de siempre) -->
    <button type="button" class="relative" (click)="goToCart()">
      <!-- tu SVG de carrito -->
      <svg
        width="26"
        height="26"
        viewBox="0 0 26 26"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M19.6667 19.6667C18.1939 19.6667 17 20.8606 17 22.3333C17 23.8061 18.1939 25 19.6667 25C21.1394 25 22.3333 23.8061 22.3333 22.3333C22.3333 20.8606 21.1394 19.6667 19.6667 19.6667ZM19.6667 19.6667H9.39193C8.77718 19.6667 8.46924 19.6667 8.21615 19.5573C7.99288 19.4608 7.79918 19.3055 7.65805 19.1074C7.49987 18.8854 7.43625 18.5884 7.31032 18.0007L4.02865 2.6862C3.89978 2.08485 3.83449 1.78451 3.67448 1.5599C3.53335 1.3618 3.33969 1.20589 3.11642 1.1094C2.86327 1 2.55705 1 1.94205 1H1M5 5H22.1643C23.1267 5 23.6074 5 23.9304 5.20048C24.2133 5.37609 24.4204 5.6515 24.5107 5.97201C24.6138 6.33791 24.4814 6.79995 24.2146 7.72461L22.3685 14.1246C22.209 14.6775 22.1292 14.9534 21.9674 15.1585C21.8246 15.3396 21.6363 15.4813 21.4227 15.5684C21.1815 15.6667 20.8948 15.6667 20.3228 15.6667H7.30729M7.66667 25C6.19391 25 5 23.8061 5 22.3333C5 20.8606 6.19391 19.6667 7.66667 19.6667C9.13943 19.6667 10.3333 20.8606 10.3333 22.3333C10.3333 23.8061 9.13943 25 7.66667 25Z"
          stroke="#1E1E1E"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>

      <ng-container *ngIf="cartCount$ | async as count">
        <span
          class="absolute -top-2 -right-2 flex h-4 w-4 items-center justify-center rounded-full bg-red-500 text-[10px] text-white"
          >{{count}}</span
        >
      </ng-container>
    </button>

    <!-- PERFIL -->
    <div class="relative">
      <!-- Botón de perfil SIEMPRE visible -->
      <button
        type="button"
        class="flex items-center justify-center w-9 h-9 text-primary hover:bg-slate-50 relative"
        (click)="handleProfileClick()"
      >
        <svg
          width="26"
          height="26"
          viewBox="0 0 26 26"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M19.9555 22.7764C18.2466 20.8677 15.7635 19.6667 13 19.6667C10.2365 19.6667 7.75323 20.8677 6.04427 22.7764M13 25C6.37258 25 1 19.6274 1 13C1 6.37258 6.37258 1 13 1C19.6274 1 25 6.37258 25 13C25 19.6274 19.6274 25 13 25ZM13 15.6667C10.7909 15.6667 9 13.8758 9 11.6667C9 9.45753 10.7909 7.66667 13 7.66667C15.2091 7.66667 17 9.45753 17 11.6667C17 13.8758 15.2091 15.6667 13 15.6667Z"
            stroke="#1E1E1E"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>

        <!-- indicador de logueado: puntico verde -->
        <span
          *ngIf="currentUser"
          class="absolute top-0.5 right-0 h-2.5 w-2.5 rounded-full bg-emerald-500 border border-white"
        ></span>
      </button>

      <!-- DROPDOWN (solo si hay usuario y el menú está abierto) -->
      <ng-container *ngIf="isProfileMenuOpen && currentUser as user">
        <div
          class="absolute right-0 mt-2 w-56 bg-white rounded-2xl shadow-xl border border-deafuera p-3 overflow-hidden z-50"
        >
          <!-- Perfil -->
          <button
            type="button"
            class="w-full flex items-center rounded-lg gap-3 px-4 py-3 hover:bg-relleno text-primary text-[16px] hover:font-semibold"
            (click)="goToProfile()"
          >
            <svg
              width="17"
              height="17"
              viewBox="0 0 17 17"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M12.8472 14.6102C11.7791 13.4173 10.2272 12.6667 8.5 12.6667C6.77279 12.6667 5.22077 13.4173 4.15267 14.6102M8.5 16C4.35786 16 1 12.6421 1 8.5C1 4.35786 4.35786 1 8.5 1C12.6421 1 16 4.35786 16 8.5C16 12.6421 12.6421 16 8.5 16ZM8.5 10.1667C7.11929 10.1667 6 9.04738 6 7.66667C6 6.28595 7.11929 5.16667 8.5 5.16667C9.88071 5.16667 11 6.28595 11 7.66667C11 9.04738 9.88071 10.1667 8.5 10.1667Z"
                stroke="#022954"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>

            <span>Perfil</span>
          </button>

          <!-- Mis pedidos -->
          <button
            type="button"
            class="w-full flex items-center gap-3 px-4 py-3 text-[16px] text-primary hover:bg-relleno hover:rounded-lg hover:font-semibold"
            (click)="goToOrders()"
          >
            <svg
              width="16"
              height="16"
              viewBox="0 0 16 16"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M7.66667 10.1667L10.1667 7.66667M10.1667 7.66667L7.66667 5.16667M10.1667 7.66667H1M5.16667 3.70716V3.66683C5.16667 2.73341 5.16667 2.26635 5.34832 1.90983C5.50811 1.59623 5.76289 1.34144 6.0765 1.18166C6.43302 1 6.90008 1 7.8335 1H11.6668C12.6003 1 13.0663 1 13.4228 1.18166C13.7364 1.34144 13.9921 1.59623 14.1519 1.90983C14.3333 2.266 14.3333 2.73249 14.3333 3.66409V11.6696C14.3333 12.6012 14.3333 13.0671 14.1519 13.4232C13.9921 13.7368 13.7364 13.9921 13.4228 14.1519C13.0667 14.3333 12.6008 14.3333 11.6692 14.3333H7.83076C6.89916 14.3333 6.43267 14.3333 6.0765 14.1519C5.76289 13.9921 5.50811 13.7366 5.34832 13.423C5.16667 13.0665 5.16667 12.6001 5.16667 11.6667V11.625"
                stroke="#022954"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>

            <span>Mis pedidos</span>
          </button>

          <!-- Cerrar sesión -->
          <button
            type="button"
            class="w-full flex items-center gap-3 px-4 py-3 text-[16px] hover:font-semibold text-red-500 hover:bg-red-50 hover:rounded-lg"
            (click)="logout()"
          >
            <svg
              width="16"
              height="16"
              viewBox="0 0 16 16"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M7.66667 10.1667L10.1667 7.66667M10.1667 7.66667L7.66667 5.16667M10.1667 7.66667H1M5.16667 3.70716V3.66683C5.16667 2.73341 5.16667 2.26635 5.34832 1.90983C5.50811 1.59623 5.76289 1.34144 6.0765 1.18166C6.43302 1 6.90008 1 7.8335 1H11.6668C12.6003 1 13.0663 1 13.4228 1.18166C13.7364 1.34144 13.9921 1.59623 14.1519 1.90983C14.3333 2.266 14.3333 2.73249 14.3333 3.66409V11.6696C14.3333 12.6012 14.3333 13.0671 14.1519 13.4232C13.9921 13.7368 13.7364 13.9921 13.4228 14.1519C13.0667 14.3333 12.6008 14.3333 11.6692 14.3333H7.83076C6.89916 14.3333 6.43267 14.3333 6.0765 14.1519C5.76289 13.9921 5.50811 13.7366 5.34832 13.423C5.16667 13.0665 5.16667 12.6001 5.16667 11.6667V11.625"
                stroke="#EB0C0C"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>

            <span>Cerrar sesión</span>
          </button>
        </div>
      </ng-container>
    </div>
  </div>

  <!-- Modal de login/registro (puede ir aquí o en el layout principal) -->
  <app-auth-modal *ngIf="showAuthModal" (close)="closeAuth()"></app-auth-modal>

  <!-- MENÚ MÓVIL TIPO DESPLEGABLE -->
  <div
    *ngIf="mobileMenuOpen"
    class="fixed inset-0 z-40 flex justify-center items-start bg-black/30"
  >
    <div class="mt-6 w-[92%] max-w-sm bg-white rounded-3xl shadow-lg p-5">
      <!-- header del panel: logo + botón cerrar -->
      <div class="flex items-center justify-between mb-4">
        <a [routerLink]="['/']" class="flex items-center gap-2">
          <img
            src="/assets/icons/fadiarLogo.png"
            alt="Grupo Fadiar"
            class="h-8"
          />
        </a>

        <button type="button" (click)="closeMobileMenu()" class="p-1">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M6 6L18 18M18 6L6 18"
              stroke="#111827"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </button>
      </div>

      <hr class="border-slate-200 mb-5" />

      <nav class="bg-background px-3">
        <ul
          class="flex flex-col items-start w-full gap-5 md:gap-10 xl:gap-14 text-[16px] font-sans"
        >
          <li>
            <a
              routerLink="/"
              routerLinkActive="font-bold"
              (click)="closeMobileMenu()"
              class="hover:underline text-background-dark cursor-pointer transition"
            >
              Inicio
            </a>
          </li>

          <li>
            <a
              routerLink="/product"
              routerLinkActive="font-bold"
              (click)="closeMobileMenu()"
              class="hover:underline text-background-dark transition"
            >
              Productos
            </a>
          </li>

          <li>
            <a
              routerLink="/about"
              routerLinkActive="font-bold"
              (click)="closeMobileMenu()"
              class="hover:underline text-background-dark transition"
            >
              About Us
            </a>
          </li>

          <li>
            <a
              routerLink="/faq"
              routerLinkActive="font-bold"
              (click)="closeMobileMenu()"
              class="hover:underline text-background-dark transition"
            >
              FAQ
            </a>
          </li>

          <li>
            <a
              routerLink="/contacto"
              routerLinkActive="font-bold"
              (click)="closeMobileMenu()"
              class="hover:underline text-background-dark transition"
            >
              Contacto
            </a>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</header>
