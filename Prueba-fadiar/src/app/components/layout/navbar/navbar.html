<header class="w-full flex bg-white justify-around items-center">
  <!--izquierda-->
  <div class="flex items-center gap-3">
    <!-- Botón hamburguesa SOLO móvil -->
    <button
      type="button"
      class="md:hidden p-2 -ml-2"
      (click)="toggleMobileMenu()"
    >
      <svg
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M4 7H20M4 12H20M4 17H20"
          stroke="#022954"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
    </button>

    <!-- LOGO (deja tus clases actuales) -->
    <a [routerLink]="['/']" class="flex items-center">
      <img
        src="/assets/icons/fadiarLogo.png"
        alt="Grupo Fadiar"
        class="h-15 hidden md:inline"
      />
    </a>
  </div>

  <!--centro-->
  <div class="flex-col mx-2">
    <app-product-search
      (termChange)="onTermChange($event)"
    ></app-product-search>

    <div class="bg-background px-3 hidden sm:inline">
      <ul
        class="flex items-center justify-center w-full gap-5 md:gap-10 xl:gap-14 text-sm font-sans"
      >
        <li>
          <a
            routerLink="/"
            routerLinkActive="font-bold"
            class="hover:text-primary cursor-pointer transition"
          >
            Inicio
          </a>
        </li>

        <li>
          <a
            routerLink="/product"
            routerLinkActive="font-bold"
            class="hover:text-primary transition"
          >
            Productos
          </a>
        </li>

        <li>
          <a
            routerLink="/about"
            routerLinkActive="font-bold"
            class="hover:text-primary transition"
          >
            About Us
          </a>
        </li>

        <li>
          <a
            routerLink="/faq"
            routerLinkActive="font-bold"
            class="hover:text-primary transition"
          >
            FAQ
          </a>
        </li>

        <li>
          <a
            routerLink="/contacto"
            routerLinkActive="font-bold"
            class="hover:text-primary transition"
          >
            Contacto
          </a>
        </li>
      </ul>
    </div>
  </div>

  <!--derecha-->
  <div class="flex items-center gap-3 md:gap-6 w-auto justify-center">
    <!--Carrito-->
    <button
      type="button"
      class="relative text-text hover:text-primary transition"
      (click)="goToCart()"
    >
      <svg
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g id="Interface / Shopping_Cart_02">
          <path
            id="Vector"
            d="M3 3H3.26835C3.74213 3 3.97943 3 4.17267 3.08548C4.34304 3.16084 4.48871 3.28218 4.59375 3.43604C4.71269 3.61026 4.75564 3.8429 4.84137 4.30727L7.00004 16L17.4218 16C17.875 16 18.1023 16 18.29 15.9199C18.4559 15.8492 18.5989 15.7346 18.7051 15.5889C18.8252 15.4242 18.8761 15.2037 18.9777 14.7631L18.9785 14.76L20.5477 7.95996L20.5481 7.95854C20.7023 7.29016 20.7796 6.95515 20.6947 6.69238C20.6202 6.46182 20.4635 6.26634 20.2556 6.14192C20.0184 6 19.6758 6 18.9887 6H5.5M18 21C17.4477 21 17 20.5523 17 20C17 19.4477 17.4477 19 18 19C18.5523 19 19 19.4477 19 20C19 20.5523 18.5523 21 18 21ZM8 21C7.44772 21 7 20.5523 7 20C7 19.4477 7.44772 19 8 19C8.55228 19 9 19.4477 9 20C9 20.5523 8.55228 21 8 21Z"
            stroke="#1e1e1e"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </g>
      </svg>

      <span
        class="absolute -top-2 -right-2 flex h-5 w-5 items-center justify-center rounded-full bg-red-500 text-xs text-white"
        *ngIf="(cartCount$ | async) as count"
      >
        {{ count }}
      </span>
    </button>

    <!--Perfil-->
    <div class="flex items-center gap-3">
      <!-- SI NO HAY USUARIO: mostrar botón login -->
      <ng-container
        *ngIf="(currentUser$ | async) as user; else showLoginButton"
      >
        <!-- Usuario logueado: icono + nombre + menú simple -->
        <div class="flex items-center gap-2">
          <div
            class="w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center text-sm font-bold"
          >
            {{ user.name[0] | uppercase }}
          </div>
          <span class="text-sm text-primary hidden sm:inline">
            {{ user.name }}
          </span>
          <button class="text-xs text-accent underline" (click)="logout()">
            Cerrar sesión
          </button>
        </div>
      </ng-container>

      <!-- NO LOGUEADO: botón perfil que abre el modal -->
      <ng-template #showLoginButton>
        <button
          type="button"
          class="w-6 h-6 flex items-center justify-center"
          (click)="openAuth()"
        >
          <!-- icono de perfil -->
          <svg
            width="26"
            height="26"
            viewBox="0 0 26 26"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M19.9555 22.7764C18.2466 20.8677 15.7635 19.6667 13 19.6667C10.2365 19.6667 7.75323 20.8677 6.04427 22.7764M13 25C6.37258 25 1 19.6274 1 13C1 6.37258 6.37258 1 13 1C19.6274 1 25 6.37258 25 13C25 19.6274 19.6274 25 13 25ZM13 15.6667C10.7909 15.6667 9 13.8758 9 11.6667C9 9.45753 10.7909 7.66667 13 7.66667C15.2091 7.66667 17 9.45753 17 11.6667C17 13.8758 15.2091 15.6667 13 15.6667Z"
              stroke="#1E1E1E"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </button>
      </ng-template>
    </div>
    <!-- MODAL LOGIN/REGISTRO -->
    <app-auth-modal
      *ngIf="showAuthModal"
      (close)="closeAuth()"
    ></app-auth-modal>
  </div>

  <!-- MENÚ MÓVIL TIPO DESPLEGABLE -->
  <div
    *ngIf="mobileMenuOpen"
    class="fixed inset-0 z-40 flex justify-center items-start bg-black/30"
  >
    <div class="mt-6 w-[92%] max-w-sm bg-white rounded-3xl shadow-lg p-5">
      <!-- header del panel: logo + botón cerrar -->
      <div class="flex items-center justify-between mb-4">
        <a [routerLink]="['/']" class="flex items-center gap-2">
          <img
            src="/assets/icons/fadiarLogo.png"
            alt="Grupo Fadiar"
            class="h-8"
          />
        </a>

        <button type="button" (click)="closeMobileMenu()" class="p-1">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M6 6L18 18M18 6L6 18"
              stroke="#111827"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </button>
      </div>

      <hr class="border-slate-200 mb-5" />

      <!-- aquí REUSAMOS los mismos links del template -->

      <nav class="bg-background px-3">
        <ul
          class="flex flex-col items-start w-full gap-5 md:gap-10 xl:gap-14 text-[16px] font-sans"
        >
          <li>
            <a
              routerLink="/"
              routerLinkActive="font-bold"
              (click)="closeMobileMenu()"
              class="hover:underline text-background-dark cursor-pointer transition"
            >
              Inicio
            </a>
          </li>

          <li>
            <a
              routerLink="/product"
              routerLinkActive="font-bold"
              (click)="closeMobileMenu()"
              class="hover:underline text-background-dark transition"
            >
              Productos
            </a>
          </li>

          <li>
            <a
              routerLink="/about"
              routerLinkActive="font-bold"
              (click)="closeMobileMenu()"
              class="hover:underline text-background-dark transition"
            >
              About Us
            </a>
          </li>

          <li>
            <a
              routerLink="/faq"
              routerLinkActive="font-bold"
              (click)="closeMobileMenu()"
              class="hover:underline text-background-dark transition"
            >
              FAQ
            </a>
          </li>

          <li>
            <a
              routerLink="/contacto"
              routerLinkActive="font-bold"
              (click)="closeMobileMenu()"
              class="hover:underline text-background-dark transition"
            >
              Contacto
            </a>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</header>
